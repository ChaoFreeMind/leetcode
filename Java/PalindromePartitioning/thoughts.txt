This problem is pretty interesting backtracking( + DB) problem.