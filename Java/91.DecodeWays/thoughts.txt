This problem is a little bit tricky. At first I did not even try to solve it by DP...

